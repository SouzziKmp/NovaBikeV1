<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{general/fragmentos :: head}">
    <title>Reporte de Stock | NovaBike</title>

    <!-- Estilos para visualizaci√≥n e impresi√≥n -->
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        h2 {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
        }

        th, td {
            border: 1px solid #333;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #222;
            color: white;
        }

        /* Ocultar botones y elementos no deseados en impresi√≥n */
        @media print {
            .no-print {
                display: none !important;
            }

            header,
            footer {
                display: none !important;
            }

            body {
                background: white !important;
                color: black !important;
            }
        }
    </style>
</head>

<body class="bg-dark text-white">

<!-- HEADER -->
<header th:replace="~{general/fragmentos :: header}"></header>

<div class="container py-5">

    <h2 class="fw-bold text-white">Reporte de Stock ‚Äì NovaBike</h2>

    <p class="text-center text-white-50 mb-4">
        Generado el:
        <span th:text="${#dates.format(#dates.createNow(), 'dd/MM/yyyy HH:mm')}"></span>
    </p>

    <!-- TABLA DE PRODUCTOS -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped text-dark bg-light">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Descripci√≥n</th>
                    <th>Precio (‚Ç°)</th>
                    <th>Descuento (%)</th>
                </tr>
            </thead>

            <tbody>
                <tr th:each="p : ${productos}">
                    <td th:text="${p.id}"></td>
                    <td th:text="${p.nombre}"></td>
                    <td th:text="${p.descripcion}"></td>

                    <td>
                        <span th:if="${p.descuento == null or p.descuento == 0}">
                            ‚Ç°[[${#numbers.formatDecimal(p.precio, 0, 'POINT', 2, 'COMMA')}]]
                        </span>

                        <span th:if="${p.descuento != null and p.descuento > 0}">
                            <span class="text-decoration-line-through text-danger">
                                ‚Ç°[[${#numbers.formatDecimal(p.precio, 0, 'POINT', 2, 'COMMA')}]]
                            </span>
                            <br>
                            <span class="fw-bold text-success">
                                ‚Ç°[[${@productoService.calcularPrecioConDescuento(p)}]]
                            </span>
                        </span>
                    </td>

                    <td th:text="${p.descuento != null ? p.descuento : 0}"></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- BOTONES -->
    <div class="text-center mt-4 no-print">
        <button onclick="window.print()" class="btn btn-light fw-bold me-3">
            üñ® Imprimir / Exportar PDF
        </button>

        <a th:href="@{/producto/listado}" class="btn btn-outline-light fw-bold">
            ‚¨Ö Volver a la Gesti√≥n
        </a>
    </div>

</div>

<!-- FOOTER -->
<footer class="no-print" th:replace="~{general/fragmentos :: footer}"></footer>

</body>
</html>
